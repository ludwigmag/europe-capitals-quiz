<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Europe Capitals Quiz (35 Questions)</title>
  <style>
    :root { color-scheme: light dark; }
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      margin:0;padding:24px;display:grid;place-items:center;
      background:#0b1020;color:#eef2ff;
    }
    .card{
      width:min(900px,100%);
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:18px;
      padding:22px;
      box-shadow:0 12px 35px rgba(0,0,0,0.35);
    }
    h1{margin:0 0 10px;font-size:22px}
    .sub{opacity:.85;margin:0 0 18px}
    .topbar{
      display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;
      font-size:14px;opacity:.95;margin-bottom:14px;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{
      padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.14);
    }
    .smallbtn{
      padding:8px 10px;border-radius:10px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.08);
      color:inherit;cursor:pointer;
    }
    .smallbtn:hover{background:rgba(255,255,255,0.12)}
    .country{
      font-size:34px;font-weight:800;letter-spacing:.3px;
      margin:10px 0 12px; display:flex; gap:12px; align-items:center;
    }
    .flagWrap{
      width:48px;height:36px;border-radius:10px;overflow:hidden;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.08);
      display:grid;place-items:center;
      flex: 0 0 auto;
    }
    .flagWrap img{width:100%;height:100%;object-fit:cover;display:block}
    .flagFallback{
      font-size:12px;opacity:.85;font-weight:700;letter-spacing:.5px;
    }
    .choices{display:grid;gap:10px;margin-top:12px}
    button.choice{
      text-align:left;font-size:16px;padding:14px 14px;border-radius:12px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.08);color:inherit;cursor:pointer;
      transition:transform .06s ease, background .15s ease, border-color .15s ease, opacity .15s ease;
    }
    button.choice:hover{background:rgba(255,255,255,0.12)}
    button.choice:active{transform:translateY(1px)}
    button.choice[disabled]{cursor:not-allowed;opacity:.75}
    .note{
      margin-top:14px;padding:12px 14px;border-radius:12px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.06);
      min-height:22px;
      opacity:.9;
    }
    .results{
      margin-top:18px;
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.06);
    }
    .results h2{margin:0 0 10px;font-size:18px}
    .wrongList{margin:10px 0 0; padding-left: 18px}
    .wrongList li{margin:8px 0; line-height:1.35}
    code.k{padding:2px 6px;border-radius:8px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.12)}
    @media (prefers-color-scheme: light){
      body{background:#f6f8ff;color:#10162a}
      .card{background:white;border-color:rgba(16,22,42,.12);box-shadow:0 12px 35px rgba(16,22,42,0.08)}
      button.choice{background:#f3f5ff;border-color:rgba(16,22,42,.12)}
      button.choice:hover{background:#e9edff}
      .note,.results{background:#f7f8ff;border-color:rgba(16,22,42,.12)}
      .pill,.smallbtn{background:#f3f5ff;border-color:rgba(16,22,42,.12)}
      .flagWrap{background:#f3f5ff;border-color:rgba(16,22,42,.12)}
      code.k{background:#f3f5ff;border-color:rgba(16,22,42,.12)}
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="topbar">
      <div class="row">
        <div class="pill">Region: <strong>Europe</strong></div>
        <div class="pill">Question: <strong id="qnum">1</strong>/35</div>
      </div>
      <div class="row">
        <button class="smallbtn" id="resetBtn" title="Start a new 35-question quiz">New 35</button>
      </div>
    </div>

    <h1>Pick the correct capital</h1>
    <p class="sub">35 random countries. No feedback until the final score.</p>

    <div class="country">
      <div class="flagWrap" id="flagWrap">
        <!-- Flag image injected here -->
      </div>
      <div id="countryName">‚Äî</div>
    </div>

    <div class="choices" id="choices"></div>

    <div class="note" id="note">Pick one option. We‚Äôll show your final score at the end.</div>

    <div class="results" id="results" style="display:none;"></div>
  </div>

  <script>
    // [country, capital, ISO2]
    const EUROPE = [
      ["Albania","Tirana","AL"],
      ["Andorra","Andorra la Vella","AD"],
      ["Austria","Vienna","AT"],
      ["Belarus","Minsk","BY"],
      ["Belgium","Brussels","BE"],
      ["Bosnia and Herzegovina","Sarajevo","BA"],
      ["Bulgaria","Sofia","BG"],
      ["Croatia","Zagreb","HR"],
      ["Cyprus","Nicosia","CY"],
      ["Czechia","Prague","CZ"],
      ["Denmark","Copenhagen","DK"],
      ["Estonia","Tallinn","EE"],
      ["Finland","Helsinki","FI"],
      ["France","Paris","FR"],
      ["Germany","Berlin","DE"],
      ["Greece","Athens","GR"],
      ["Hungary","Budapest","HU"],
      ["Iceland","Reykjavik","IS"],
      ["Ireland","Dublin","IE"],
      ["Italy","Rome","IT"],
      ["Kosovo","Pristina","XK"],       // flag image fallback if not available
      ["Latvia","Riga","LV"],
      ["Liechtenstein","Vaduz","LI"],
      ["Lithuania","Vilnius","LT"],
      ["Luxembourg","Luxembourg","LU"],
      ["Malta","Valletta","MT"],
      ["Moldova","Chi»ôinƒÉu","MD"],
      ["Monaco","Monaco","MC"],
      ["Montenegro","Podgorica","ME"],
      ["Netherlands","Amsterdam","NL"],
      ["North Macedonia","Skopje","MK"],
      ["Norway","Oslo","NO"],
      ["Poland","Warsaw","PL"],
      ["Portugal","Lisbon","PT"],
      ["Romania","Bucharest","RO"],
      ["Russia","Moscow","RU"],
      ["San Marino","San Marino","SM"],
      ["Serbia","Belgrade","RS"],
      ["Slovakia","Bratislava","SK"],
      ["Slovenia","Ljubljana","SI"],
      ["Spain","Madrid","ES"],
      ["Sweden","Stockholm","SE"],
      ["Switzerland","Bern","CH"],
      ["Ukraine","Kyiv","UA"],
      ["United Kingdom","London","GB"],
      ["Vatican City","Vatican City","VA"]
    ];

    const QUESTION_COUNT = 35;

    const $country = document.getElementById("countryName");
    const $flagWrap = document.getElementById("flagWrap");
    const $choices = document.getElementById("choices");
    const $qnum = document.getElementById("qnum");
    const $note = document.getElementById("note");
    const $results = document.getElementById("results");
    const $reset = document.getElementById("resetBtn");

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }

    function sampleWithoutReplacement(data, n){
      const copy = [...data];
      shuffle(copy);
      return copy.slice(0, Math.min(n, copy.length));
    }

    function pickWrongCapitals(correctCapital, count=2){
      const capitals = EUROPE.map(x => x[1]).filter(c => c !== correctCapital);
      shuffle(capitals);
      return capitals.slice(0, count);
    }

    function renderFlag(iso2){
      // Use FlagCDN images so flags work everywhere (mobile included).
      // Some codes like XK may not exist ‚Äî we handle onerror.
      const code = (iso2 || "").toLowerCase();
      $flagWrap.innerHTML = "";

      const img = document.createElement("img");
      img.alt = iso2 ? `${iso2} flag` : "flag";
      img.loading = "lazy";
      img.decoding = "async";
      // 48px wide container. Use 40px images + retina.
      img.src = `https://flagcdn.com/w40/${code}.png`;
      img.srcset = `https://flagcdn.com/w40/${code}.png 1x, https://flagcdn.com/w80/${code}.png 2x`;

      img.onerror = () => {
        $flagWrap.innerHTML = `<span class="flagFallback">${(iso2 || "??")}</span>`;
      };

      $flagWrap.appendChild(img);
    }

    // --- Game state ---
    let questions = [];
    let index = 0;
    let answers = []; // { country, iso2, correct, chosen }

    function startNewQuiz(){
      $results.style.display = "none";
      $results.innerHTML = "";
      $note.textContent = "Pick one option. We‚Äôll show your final score at the end.";

      answers = [];
      index = 0;
      questions = sampleWithoutReplacement(EUROPE, QUESTION_COUNT);

      renderQuestion();
    }

    function renderQuestion(){
      if(index >= questions.length){
        showResults();
        return;
      }

      const [country, capital, iso2] = questions[index];
      $country.textContent = country;
      renderFlag(iso2);
      $qnum.textContent = String(index + 1);

      const options = shuffle([capital, ...pickWrongCapitals(capital, 2)]);
      $choices.innerHTML = "";

      options.forEach(opt => {
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.type = "button";
        btn.textContent = opt;
        btn.addEventListener("click", () => chooseAnswer(opt));
        $choices.appendChild(btn);
      });
    }

    function disableChoices(){
      [...$choices.querySelectorAll("button.choice")].forEach(b => b.disabled = true);
    }

    function chooseAnswer(chosen){
      const [country, correct, iso2] = questions[index];

      answers.push({ country, iso2, correct, chosen });
      disableChoices();

      // No feedback ‚Äî just continue shortly
      setTimeout(() => {
        index += 1;
        renderQuestion();
      }, 200);
    }

    function showResults(){
      $choices.innerHTML = "";
      $country.textContent = "Finished!";
      $flagWrap.innerHTML = `<span class="flagFallback">üèÅ</span>`;
      $note.textContent = "Results are below. Tap ‚ÄúNew 35‚Äù to play again.";

      const wrong = answers.filter(a => a.chosen !== a.correct);
      const score = answers.length - wrong.length;

      const wrongHtml = wrong.length === 0
        ? `<p>Perfect score. Nothing wrong üéØ</p>`
        : `
          <p>You got <strong>${wrong.length}</strong> wrong:</p>
          <ol class="wrongList">
            ${wrong.map(w => `
              <li>
                <strong>${w.country}</strong> ‚Äî
                you chose <code class="k">${escapeHtml(w.chosen)}</code>,
                correct is <code class="k">${escapeHtml(w.correct)}</code>
              </li>
            `).join("")}
          </ol>
        `;

      $results.innerHTML = `
        <h2>Final score: ${score}/${answers.length}</h2>
        ${wrongHtml}
      `;
      $results.style.display = "block";
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    $reset.addEventListener("click", startNewQuiz);

    startNewQuiz();
  </script>
</body>
</html>
